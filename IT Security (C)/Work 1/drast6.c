#include <stdio.h>
#include <openssl/bn.h>

void printBN(char *msg, BIGNUM * a);

int main()
{
	BN_CTX *ctx = BN_CTX_new();
	BIGNUM *e = BN_new();
	BIGNUM *n = BN_new();
	BIGNUM *signature = BN_new();
	BIGNUM *msg = BN_new();

	// Vhma 2 e
	BN_hex2bn(&e, "10001");
	// Vhma 2 n
	BN_hex2bn(&n, "C5760F0FD943293B6C6DD147ADDE10BF23C278A84A7735F1235BE04C1E41E7C23100BD88374575DDB90210801E8FED64230445A7A0393B814DCF633FC249FF229E88B0D296B95C8A741F922A2AF212C8B76854B55841814068061A4F8529FBB54D3C0F4F3F40961BCEA8CC5E35FF6498F575DD745405A036110412245563EF94772E77F11576EED3A45945219FA8BED127ED0AE8AB38CA3F87D1DAF18FB90B1F44E7E0ADF395C2164DEC84A33A92D4CFC67DE6BDCB1A404FB354B1F38F6F0D1EE3BE49A356E407BC8DA7CE1DB05B5756D1C41CFC9865D1CD462F9194BF458549F86D52871C0256012716AB722EF471E461B520A0FA26696A0AF1AB9F6DB7CF25");
	// Vhma 3 signature.txt
	BN_hex2bn(&signature, "7e8ecc2e0d4cfee069e686d37aff5b9669fbf348ec6bd255b0f111d2d09b61e39d473c877eeb539de84e966a29f5674f4031458a26a43d7ae4c9c9edadd619b4389be4acada8c3541468ed6687c0825b73e37a721a97443e90cec7e2f02989b0f43bf5ccc5f38c5866f9e342911f2599145856ed7ae7407ec1b341809a2e0ba57963fcc9235ad42112f569ee9efe94a14aa99b72ded690666adc37fccee679db87b473ebaaebe2253c31cca06c4748fcc47520055be26d50364a7d82c84ca3e1fc5f0fdf63507b5269085fa362e2127e411bc86feea9dafc738118aa1109e58e6099176a63e7b343442755f2f9bbc584af6bf0f3c651859c982ddf45ec81b9c6");

	// msg = signature ^ e mod n
	BN_mod_exp(msg, signature, e, n, ctx);

	// Ektypwsh apotelesmatwn
	printBN("msg = ", msg);
}

void printBN(char *msg, BIGNUM * a)
{
	char * number_str = BN_bn2hex(a);
	printf("%s%s\n", msg, number_str);
	OPENSSL_free(number_str);
}